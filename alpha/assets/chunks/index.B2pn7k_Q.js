import{d as F,aB as N,a$ as W,aC as S,h as v,c as u,o as s,j as m,e as I,F as w,B as E,n as D,t as k,G as y,k as e,b as U,ag as q,K as Y,w as A,a0 as L,aw as Z,p as $,s as ee,P as te,N as ae}from"./framework.DrGfhPAt.js";import{e as le,k as se,X as re,x as ie,B as oe}from"./tiny-robot-svgs.BbDZZ-ON.js";import{I as ne}from"./index.DEUmgi2i.js";import{T as z}from"./index.DEgDKdua.js";import{t as V}from"./index.waylIDgf.js";import{U as ce}from"./index2.BzGNBP-0.js";import{s as M}from"./plugin-vue_export-helper.lGy7RumW.js";const ue=F({__name:"item-tag",props:{text:{},type:{default:"default"},style:{}},setup(r){const t=r;return(l,p)=>(s(),u("div",{class:D(["tr-history__item-tag",t.type]),style:ae(t.style)},[m("span",null,k(t.text),1)],6))}}),de=M(ue,[["__scopeId","data-v-346767bb"]]),pe={class:"tr-history__empty"},me={class:"tr-history__empty-icon"},ve={class:"tr-history__empty-text"},ye=F({__name:"search-empty",props:{text:{default:"暂无内容"}},setup(r){const t=r;return(l,p)=>(s(),u("div",pe,[m("span",me,[y(e(oe))]),m("span",ve,k(t.text),1)]))}}),_e=M(ye,[["__scopeId","data-v-b21f5bc0"]]),he=r=>{const t=$(),l=c=>{t.value={id:c.id,title:c.title,rawData:c}},p=$(null),_=c=>{c&&te(()=>{p.value=c,p.value.focus()})};let i;const h=()=>{if(t.value){if(t.value.title!==t.value.rawData.title){const{title:c,rawData:T}=t.value;r("item-title-change",c,T)}t.value=void 0}i==null||i(),i=void 0},g=()=>{t.value=void 0,i==null||i(),i=void 0},b=c=>{c.key==="Enter"?h():c.key==="Escape"&&g()};return ee(()=>{p.value&&(i==null||i(),i=ce(p,()=>{h()}))}),{editingItem:t,handleEdit:l,handleEditorInputRef:_,handleKeyDown:b}},fe={class:"tr-history"},ke={class:"tr-history__tabs"},ge=["onClick"],be={key:0,class:"tr-history__search"},xe={class:"tr-history__content"},Ce={key:0,class:"tr-history__group-title"},we=["onClick"],Te={class:"tr-history__item-title"},Be={class:"tr-history__item-actions"},Ie={class:"tr-history__close"},Ee=F({__name:"index",props:N({tabTitle:{},data:{},activeTab:{},searchBar:{type:Boolean},searchQuery:{},searchPlaceholder:{},searchFn:{type:Function,default:(r,{title:t})=>r?t.toLowerCase().includes(r.toLowerCase()):!0},selected:{},tabs:{}},{activeTab:{},activeTabModifiers:{},searchQuery:{},searchQueryModifiers:{}}),emits:N(["close","item-click","item-title-change","item-delete"],["update:activeTab","update:searchQuery"]),setup(r,{emit:t}){W(a=>({"3a9ca538":b.value?"1px solid rgb(240, 240, 240)":"none","0b9d3e32":b.value?"2px solid rgb(25, 25, 25)":"none"}));const l=r,p=S(r,"activeTab"),_=S(r,"searchQuery"),i=t,h=v(()=>Array.isArray(l.tabs)?l.tabs:[{title:l.tabTitle,id:"0"}]),g=v(()=>p.value||h.value[0].id),b=v(()=>h.value.length>1),c=a=>{var o;const n=typeof((o=a[0])==null?void 0:o.group);return n==="string"||n==="symbol"},T=v(()=>Array.isArray(l.data)?l.data||[]:l.data[g.value]||[]),B=Symbol("NO_GROUP"),P=v(()=>{const a=T.value;return c(a)?a:[{group:B,items:a}]}),x=v(()=>l.searchBar?P.value.map(a=>({...a,items:a.items.filter(o=>l.searchFn(_.value||"",o))})).filter(a=>a.items.length>0):P.value),R=v(()=>x.value.length===0?!1:x.value[0].group===B?x.value[0].items.length>0:!0),j=a=>{var o;a.id!==((o=C.value)==null?void 0:o.id)&&i("item-click",a)},G=()=>{i("close")},H=a=>{i("item-delete",a)},{editingItem:C,handleEdit:X,handleEditorInputRef:J,handleKeyDown:Q}=he(i);return(a,o)=>(s(),u("div",fe,[m("div",ke,[(s(!0),u(w,null,E(h.value,n=>(s(),u("div",{key:n.id,class:D(["tr-history__tab",{active:g.value===n.id}]),onClick:d=>p.value=n.id},k(n.title),11,ge))),128))]),l.searchBar?(s(),u("div",be,[y(e(ne),{modelValue:_.value,"onUpdate:modelValue":o[0]||(o[0]=n=>_.value=n),placeholder:l.searchPlaceholder||"搜索对话名称","prefix-icon":e(le),clearable:""},null,8,["modelValue","placeholder","prefix-icon"])])):I("",!0),m("div",xe,[R.value?(s(!0),u(w,{key:0},E(x.value,n=>(s(),u("div",{key:n.group,class:"tr-history__group"},[n.group!==e(B)?(s(),u("div",Ce,[m("span",null,k(n.group),1)])):I("",!0),(s(!0),u(w,null,E(n.items,d=>{var K;return s(),u("div",{key:`${d.id}-${d.title}`,class:D(["tr-history__item",{selected:l.selected===d.id}]),onClick:f=>j(d)},[((K=e(C))==null?void 0:K.id)!==d.id?(s(),u(w,{key:0},[m("span",Te,k(d.title),1),d.tag?(s(),U(e(de),Y({key:0,class:"tr-history__item-tag"},{ref_for:!0},d.tag),null,16)):I("",!0),m("div",Be,[y(e(z),{content:"编辑",effect:"dark",placement:"top","open-delay":500},{default:A(()=>[y(e(V),{icon:e(se),onClick:L(f=>e(X)(d),["stop"])},null,8,["icon","onClick"])]),_:2},1024),y(e(z),{content:"删除",effect:"dark",placement:"top","open-delay":500},{default:A(()=>[y(e(V),{icon:e(re),onClick:L(f=>H(d),["stop"])},null,8,["icon","onClick"])]),_:2},1024)])],64)):q((s(),u("input",{key:1,"onUpdate:modelValue":o[1]||(o[1]=f=>e(C).title=f),class:"tr-history__item-edit",ref_for:!0,ref:e(J),onKeydown:o[2]||(o[2]=(...f)=>e(Q)&&e(Q)(...f))},null,544)),[[Z,e(C).title]])],10,we)}),128))]))),128)):(s(),U(e(_e),{key:1,text:_.value?"暂无搜索结果":"暂无内容"},null,8,["text"]))]),m("div",Ie,[y(e(V),{icon:e(ie),rounded:"",onClick:G},null,8,["icon"])])]))}}),O=M(Ee,[["__scopeId","data-v-87ea1242"]]),Ve=function(r){r.component("TrHistory",O)},Se={...O,install:Ve,name:"TrHistory"};export{Se as S};
