import{R as Q,a as z,g as J,b as ee,J as le,t as ae,O as te}from"./tiny-robot-svgs.BbDZZ-ON.js";import{B as j}from"./index.Bvo3FQtB.js";import{d as O,r as W,a1 as oe,h as T,p as w,c,q as P,o as l,b as f,e as y,F as N,B as $,w as b,j as _,H as M,k as s,G as E,T as ne,ag as se,n as re,a0 as ie,t as S,ai as ue,P as Y,a as ce,v as pe}from"./framework.DrGfhPAt.js";import{T as q}from"./index.DEgDKdua.js";import{U as me,t as de}from"./index2.BzGNBP-0.js";import{t as Z}from"./index.waylIDgf.js";import{s as U}from"./plugin-vue_export-helper.lGy7RumW.js";const ve={class:"tr-action-group"},fe=["onClick"],_e=["onClick"],ke={class:"tr-action-group__dropdown-item-text"},be=O({__name:"ActionGroup",props:{maxNum:{},showTooltip:{type:Boolean},dropDownShowLabelOnly:{type:Boolean}},emits:["item-click"],setup(p,{emit:m}){const e=p,A=oe(),d=m,g=T(()=>{var i,r;const u=A.default();return Array.isArray(u)?u.length===1&&((i=u[0].type)==null?void 0:i.toString())==="Symbol(v-fgt)"?u[0].children:u:((r=u.type)==null?void 0:r.toString())==="Symbol(v-fgt)"?u.children:[u]}),C=T(()=>{const i=e.maxNum??Number.MAX_SAFE_INTEGER;return i>0?i:Number.MAX_SAFE_INTEGER}),v=T(()=>g.value.length>C.value),k=T(()=>v.value?g.value.slice(0,C.value):g.value),n=T(()=>v.value?g.value.slice(C.value):[]),a=w(null),t=w(null),o=w(!1),h=()=>{o.value=!o.value};me(t,()=>{o.value=!1},{ignore:[a]});const B=i=>{d("item-click",i),o.value=!1},I=w("placement-bottom"),{height:x}=de(),R=()=>{if(!t.value||!a.value)return"placement-bottom";const i=t.value.getBoundingClientRect(),r=a.value.getBoundingClientRect();I.value=r.bottom+i.height+16>x.value?"placement-top":"placement-bottom"};return P(o,i=>{i&&Y(()=>{R()})}),P(x,()=>{o.value&&R()}),(i,r)=>(l(),c("div",ve,[(l(!0),c(N,null,$(k.value,(u,V)=>{var F;return l(),f(s(q),{key:V,content:(F=u.props)==null?void 0:F.label,effect:"dark",placement:"top","open-delay":500,disabled:!e.showTooltip},{default:b(()=>[_("span",{class:"tr-action-group__btn-wrapper",onClick:K=>{var G;return B((G=u.props)==null?void 0:G.name)}},[(l(),f(M(u)))],8,fe)]),_:2},1032,["content","disabled"])}),128)),v.value?(l(),f(s(q),{key:0,content:"更多",effect:"dark",placement:"top","open-delay":500,disabled:!e.showTooltip},{default:b(()=>[_("span",{ref_key:"moreBtnRef",ref:a,class:"tr-action-group__btn-wrapper",onClick:h},[W(i.$slots,"moreBtn",{},()=>[E(s(Z),{icon:s(Q)},null,8,["icon"])],!0),E(ne,{name:"tr-action-group-dropdown"},{default:b(()=>[se(_("ul",{ref_key:"dropDownRef",ref:t,class:re(["tr-action-group__dropdown",I.value])},[(l(!0),c(N,null,$(n.value,(u,V)=>{var F;return l(),c("li",{class:"tr-action-group__dropdown-item",key:V,onClick:ie(K=>{var G;return B((G=u.props)==null?void 0:G.name)},["stop"])},[e.dropDownShowLabelOnly?y("",!0):(l(),f(M(u),{key:0})),_("span",ke,S((F=u.props)==null?void 0:F.label),1)],8,_e)}),128))],2),[[ue,o.value]])]),_:1})],512)]),_:3},8,["disabled"])):y("",!0)]))}}),L=U(be,[["__scopeId","data-v-f0173895"]]),X=O({__name:"ActionGroupItem",props:{name:{},label:{}},setup(p){return(m,e)=>W(m.$slots,"default")}});L.name="TrActionGroup";const ge=function(p){p.component(L.name,L)};L.install=ge;X.name="TrActionGroupItem";const ye=function(p){p.component(X.name,X)};X.install=ye;const H=X,he={class:"tr-feedback__source-list"},we=["href"],Ce=O({__name:"SourceList",props:{sources:{},linesLimit:{default:Number.MAX_SAFE_INTEGER}},setup(p){const m=p,e=w(!1),A=w([]),d=w(null),g=()=>{Y(()=>{const k=A.value.slice(0,m.sources.length).map(a=>(a==null?void 0:a.offsetTop)||0),n=Array.from(new Set(k));if(n.length>m.linesLimit){const a=n[m.linesLimit-1],t=k.lastIndexOf(a);d.value=t}else d.value=null})},C=T(()=>m.sources.length-(d.value||0));pe(g),P(()=>m.sources,g);const v=(k,n)=>{k&&(A.value[n]=k)};return(k,n)=>(l(),c("div",he,[(l(!0),c(N,null,$(m.sources,(a,t)=>(l(),c(N,{key:t},[!d.value||e.value||t<d.value?(l(),c("a",{key:0,class:"pill",href:a.link,target:"_blank",ref_for:!0,ref:o=>v(o,t)},S(a.label),9,we)):y("",!0),d.value&&!e.value&&t===d.value?(l(),c("span",{key:1,class:"pill",onClick:n[0]||(n[0]=o=>e.value=!0)},S(C.value)+"+ ",1)):y("",!0)],64))),128)),e.value?(l(),c("span",{key:0,class:"pill collapse-pill",onClick:n[1]||(n[1]=a=>e.value=!1)},[E(s(J))])):y("",!0)]))}}),Ee=U(Ce,[["__scopeId","data-v-c5fbb560"]]),Ae={class:"tr-feedback"},Te={class:"tr-feedback__operations"},Se={class:"tr-feedback__operations-left"},Ne={key:1},Le={class:"tr-feedback__operations-right"},Be={key:0,class:"tr-feedback__footer"},Ie={key:0},xe=O({__name:"index",props:{operations:{},operationsLimit:{default:Number.MAX_SAFE_INTEGER},actions:{},actionsLimit:{default:Number.MAX_SAFE_INTEGER},sources:{},sourcesLinesLimit:{default:Number.MAX_SAFE_INTEGER}},emits:["operation","action"],setup(p,{emit:m}){const e=p,A={copy:te,refresh:ae,like:le,dislike:ee},d=m,g=n=>{var a,t,o;(o=(t=(a=e.operations)==null?void 0:a.find(h=>h.name===n))==null?void 0:t.onClick)==null||o.call(t),d("operation",n)},C=n=>{var a,t,o;(o=(t=(a=e.actions)==null?void 0:a.find(h=>h.name===n))==null?void 0:t.onClick)==null||o.call(t),d("action",n)},v=w(!1),k=()=>{v.value=!v.value};return(n,a)=>{var t,o,h,B,I,x,R,i;return l(),c("div",Ae,[_("div",Te,[_("div",Se,[(t=e.operations)!=null&&t.length?(l(),f(s(L),{key:0,"max-num":e.operationsLimit,"drop-down-show-label-only":!0,onItemClick:g,class:"tr-feedback__operations-left-action-group"},{moreBtn:b(()=>[E(s(j),{round:"",size:"mini","reset-time":0,class:"tr-feedback__operations-more-btn"},{default:b(()=>[a[0]||(a[0]=_("span",null,"更多",-1)),E(s(z))]),_:1})]),default:b(()=>[(l(!0),c(N,null,$(e.operations,r=>(l(),f(s(H),{key:r.name,name:r.name,label:r.label},{default:b(()=>[E(s(j),{round:"","reset-time":0,size:"mini"},{default:b(()=>[ce(S(r.label),1)]),_:2},1024)]),_:2},1032,["name","label"]))),128))]),_:1},8,["max-num"])):(o=e.sources)!=null&&o.length?(l(),c("div",Ne,[_("span",{class:"tr-feedback__source",onClick:k},[_("span",null,S((h=e.sources)==null?void 0:h.length)+"条来源",1),(l(),f(M(v.value?s(J):s(z))))])])):y("",!0)]),_("div",Le,[E(s(L),{"max-num":e.actionsLimit,"show-tooltip":!0,onItemClick:C},{default:b(()=>[(l(!0),c(N,null,$(e.actions,r=>(l(),f(s(H),{key:r.name,name:r.name,label:r.label},{default:b(()=>[typeof r.icon=="string"?(l(),f(s(Z),{key:0,icon:A[r.icon]},null,8,["icon"])):(l(),f(M(r.icon),{key:1}))]),_:2},1032,["name","label"]))),128))]),_:1},8,["max-num"])])]),(B=e.operations)!=null&&B.length&&(I=e.sources)!=null&&I.length||v.value&&e.sources?(l(),c("div",Be,[(x=e.operations)!=null&&x.length&&(R=e.sources)!=null&&R.length?(l(),c("div",Ie,[_("span",{class:"tr-feedback__source",onClick:k},[_("span",null,S((i=e.sources)==null?void 0:i.length)+"条来源",1),(l(),f(M(v.value?s(J):s(z))))])])):y("",!0),v.value&&e.sources?(l(),f(s(Ee),{key:1,sources:e.sources,"lines-limit":e.sourcesLinesLimit},null,8,["sources","lines-limit"])):y("",!0)])):y("",!0)])}}}),D=U(xe,[["__scopeId","data-v-affa572f"]]);D.name="TrFeedback";const Re=function(p){p.component(D.name,D)};D.install=Re;export{D as C};
