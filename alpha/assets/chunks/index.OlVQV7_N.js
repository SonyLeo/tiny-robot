import{d as I,aB as W,p as P,h as y,q as H,aC as K,b as w,o as i,w as B,c as d,e as b,N as _e,n as X,j as e,G as g,t as S,k as u,F,B as J,a as fe,T as Y,r as j,ag as $,ai as he,x as ye,aw as q}from"./framework.DrGfhPAt.js";import{I as ee}from"./index.DEUmgi2i.js";import{ab as be,aa as ke,as as le,aM as xe}from"./index.BOsO13d5.js";import{R as ne}from"./index.DpDwV8Tz.js";import{S as ae}from"./index.CdFf68J2.js";import{a as Te,T as te}from"./index.BUdf_u2o.js";import{$ as Ce,x as de,e as oe,a as we,L as Ve,X as Be,B as Pe}from"./tiny-robot-svgs.BbDZZ-ON.js";import{s as A}from"./plugin-vue_export-helper.lGy7RumW.js";import{l as Ue}from"./no-data.C5XPNTdz.js";import{U as Se,K as De}from"./index2.BzGNBP-0.js";const Me={class:"plugin-card__main"},Le=["src"],$e={class:"plugin-card__content"},Fe={class:"plugin-card__info"},Ie={class:"plugin-card__name"},Ae={key:0,class:"plugin-card__count"},Re=["title"],qe={class:"plugin-card__actions"},Ne={class:"plugin-card__operations"},Oe={title:"移除插件"},ze={key:1,class:"plugin-card__add"},Ee={class:"plugin-card__tools"},je={class:"plugin-card__tool"},He={class:"plugin-card__content"},Je={class:"plugin-card__info"},Ge={class:"plugin-card__name"},Ke=["title"],Qe={class:"plugin-card__actions plugin-card__actions--tool"},We={key:0,class:"plugin-card__divider"},Xe=I({__name:"PluginCard",props:{plugin:{},mode:{default:"installed"},showToolCount:{type:Boolean,default:!0}},emits:["toggle-plugin","toggle-tool","add-plugin","delete-plugin"],setup(m,{emit:p}){const l=m,n=p,c=P(l.plugin.expanded||!1),k=y(()=>{var s;return((s=l.plugin.tools)==null?void 0:s.length)||0}),_=y(()=>k.value>0),x=y(()=>({"plugin-card--expandable":_.value,"plugin-card--expanded":c.value,[`plugin-card--${l.mode}`]:!0})),U=()=>{_.value&&(c.value=!c.value)},o=y(()=>{if(!_.value)return{checked:l.plugin.enabled||!1,indeterminate:!1};const s=l.plugin.tools.filter(V=>V.enabled),T=l.plugin.tools.length;return s.length===0?{checked:!1,indeterminate:!1}:s.length===T?{checked:!0,indeterminate:!1}:{checked:!0,indeterminate:!0}}),f=s=>{_.value&&l.plugin.tools.forEach(T=>{T.enabled!==s&&(T.enabled=s,n("toggle-tool",T.id,s))}),n("toggle-plugin",s)},N=(s,T)=>{n("toggle-tool",s,T)},v=()=>{n("delete-plugin")},C=y(()=>l.plugin.added||!1),O=()=>{const s=!C.value;n("add-plugin",s)},z=s=>s?"关闭插件":"打开插件";return(s,T)=>(i(),d("div",{class:X(["plugin-card",x.value])},[e("div",Me,[e("img",{src:s.plugin.icon,class:"plugin-card__icon"},null,8,Le),e("div",$e,[e("div",Fe,[e("span",Ie,S(s.plugin.name),1),s.showToolCount&&k.value?(i(),d("span",Ae,S(k.value)+" 个工具 ",1)):b("",!0)]),e("div",{class:"plugin-card__desc",title:s.plugin.description},S(s.plugin.description),9,Re)]),e("div",qe,[j(s.$slots,"actions",{plugin:s.plugin,expanded:c.value,mode:s.mode},()=>[s.mode==="installed"?(i(),d(F,{key:0},[_.value?(i(),d("div",{key:0,class:"plugin-card__expand",onClick:U},[j(s.$slots,"expand-icon",{expanded:c.value},()=>[c.value?(i(),w(u(we),{key:1,class:"common-icon"})):(i(),w(u(Ve),{key:0,class:"common-icon"}))],!0)])):b("",!0),e("div",Ne,[g(u(xe),{title:"确定移除该插件吗？",style:{height:"16px"},type:"info",onConfirm:v,trigger:"click"},{reference:B(()=>[j(s.$slots,"delete-icon",{},()=>[e("span",Oe,[g(u(Be),{class:"common-icon"})])],!0)]),_:3}),g(u(ae),{title:z(o.value.checked),"model-value":o.value.checked,indeterminate:o.value.indeterminate,"onUpdate:modelValue":f},null,8,["title","model-value","indeterminate"])])],64)):s.mode==="market"?(i(),d("div",ze,[j(s.$slots,"add-button",{},()=>[e("div",{class:X(["plugin-card__add-button",{"plugin-card__add-button--added":C.value}]),onClick:O},[e("span",null,S(C.value?"已添加":"添加"),1)],2)],!0)])):b("",!0)],!0)])]),_.value?(i(),w(Y,{key:0,name:"plugin-card-slide"},{default:B(()=>[$(e("div",Ee,[T[1]||(T[1]=e("div",{class:"plugin-card__divider"},null,-1)),(i(!0),d(F,null,J(s.plugin.tools,(V,L)=>{var E;return i(),d("div",{key:V.id,class:"plugin-card__tool-item"},[e("div",je,[T[0]||(T[0]=e("div",{class:"plugin-card__icon plugin-card__icon--placeholder"},null,-1)),e("div",He,[e("div",Je,[e("span",Ge,S(V.name),1)]),e("div",{class:"plugin-card__desc",title:V.description},S(V.description),9,Ke)]),e("div",Qe,[g(u(ae),{title:z(V.enabled),"model-value":V.enabled,"onUpdate:modelValue":Q=>N(V.id,Q)},null,8,["title","model-value","onUpdate:modelValue"])])]),L<(((E=s.plugin.tools)==null?void 0:E.length)||0)-1?(i(),d("div",We)):b("",!0)])}),128))],512),[[he,c.value]])]),_:1})):b("",!0)],2))}}),ie=A(Xe,[["__scopeId","data-v-dc13ac19"]]),Ye={class:"code-editor__container"},Ze={class:"code-editor__section"},el={class:"code-editor__area"},ll=I({__name:"CodeEditor",props:{codeData:{required:!0},codeDataModifiers:{}},emits:["update:codeData"],setup(m){const p=K(m,"codeData");return(l,n)=>(i(),d("div",Ye,[e("div",Ze,[n[1]||(n[1]=e("div",{class:"code-editor__header"},[e("span",{class:"code-editor__title"},"ai_plugin（填写json）")],-1)),e("div",el,[$(e("textarea",{"onUpdate:modelValue":n[0]||(n[0]=c=>p.value=c),class:"code-editor__textarea",placeholder:"请输入 JSON 配置..."},null,512),[[q,p.value]])])])]))}}),al=A(ll,[["__scopeId","data-v-87ddff5d"]]),tl={class:"form-editor__container"},ol={class:"form-editor__item"},il={class:"form-editor__item"},rl={class:"form-editor__item"},sl={class:"form-editor__item"},nl={class:"form-editor__item"},dl={class:"form-editor__item"},ul=["src"],re="https://res.hc-cdn.com/tinyui-design/1.1.0.20250526191525/home/images/tiny-ng.svg",cl=I({__name:"FormEditor",props:{formData:{required:!0},formDataModifiers:{}},emits:["update:formData"],setup(m){const p=P(""),l=K(m,"formData"),n=[{label:"sse",text:"服务器发送事件（SSE）"},{label:"streamableHttp",text:"流式HTTP（Streamable HTTP）"}],{open:c,files:k}=De({accept:"image/*",multiple:!1}),_=()=>{p.value&&p.value!==re&&(URL.revokeObjectURL(p.value),p.value="")};H(k,U=>{if(U&&U.length>0){const o=U[0];if(!o.type.startsWith("image/"))return;const f=5*1024*1024;if(o.size>f)return;_(),p.value=URL.createObjectURL(o),l.value.thumbnail=o}});const x=()=>{c()};return ye(()=>{_()}),(U,o)=>(i(),d("form",tl,[e("div",ol,[o[5]||(o[5]=e("label",{class:"form-editor__label"},"名称",-1)),$(e("input",{"onUpdate:modelValue":o[0]||(o[0]=f=>l.value.name=f),class:"form-editor__input",type:"text",placeholder:"请输入插件名称"},null,512),[[q,l.value.name]])]),e("div",il,[o[6]||(o[6]=e("label",{class:"form-editor__label"},"描述",-1)),$(e("textarea",{"onUpdate:modelValue":o[1]||(o[1]=f=>l.value.description=f),class:"form-editor__textarea",placeholder:"请输入插件描述"},null,512),[[q,l.value.description]])]),e("div",rl,[o[7]||(o[7]=e("label",{class:"form-editor__label"},"类型",-1)),g(u(ne),{modelValue:l.value.type,"onUpdate:modelValue":o[2]||(o[2]=f=>l.value.type=f),options:n,class:"form-editor__radio-group"},null,8,["modelValue"])]),e("div",sl,[o[8]||(o[8]=e("label",{class:"form-editor__label"},"URL",-1)),$(e("input",{"onUpdate:modelValue":o[3]||(o[3]=f=>l.value.url=f),class:"form-editor__input",type:"url",placeholder:"请输入插件URL"},null,512),[[q,l.value.url]])]),e("div",nl,[o[9]||(o[9]=e("label",{class:"form-editor__label"},"请求头",-1)),$(e("textarea",{"onUpdate:modelValue":o[4]||(o[4]=f=>l.value.headers=f),class:"form-editor__textarea",placeholder:"请输入请求头，格式为JSON"},null,512),[[q,l.value.headers]])]),e("div",dl,[o[11]||(o[11]=e("label",{class:"form-editor__label"},"缩略图",-1)),e("div",{class:"form-editor__file-upload",onClick:x},[e("img",{src:p.value||re,alt:"缩略图预览",class:"form-editor__file-preview-image"},null,8,ul),o[10]||(o[10]=e("div",{class:"form-editor__file-overlay"},[e("div",{class:"form-editor__file-icon"})],-1))])])]))}}),pl=A(cl,[["__scopeId","data-v-7cd7ea10"]]),ml={key:0,class:"plugin-editor__backdrop"},vl={class:"plugin-editor__header"},gl={class:"plugin-editor__content"},_l={class:"plugin-editor__add-type"},fl={key:0,class:"plugin-editor__form-editor"},hl={key:1,class:"plugin-editor__code-editor"},yl=I({__name:"PluginModal",props:{visible:{type:Boolean,required:!0},visibleModifiers:{}},emits:W(["update:visible","confirm"],["update:visible"]),setup(m,{emit:p}){const l=p,n=K(m,"visible"),c=P(null),k=P({name:"",description:"",type:"sse",url:"",headers:"",thumbnail:null}),_=P(""),x=P("form"),U=[{label:"form",text:"表单添加"},{label:"code",text:"代码添加"}],o=()=>{n.value=!1};Se(c,()=>{n.value&&o()});const f=()=>{x.value==="form"?l("confirm","form",k.value):l("confirm","code",_.value),o()};return(N,v)=>(i(),d(F,null,[n.value?(i(),d("div",ml)):b("",!0),g(Y,{name:"plugin-editor"},{default:B(()=>[n.value?(i(),d("div",{key:0,class:"plugin-editor",ref_key:"dialogRef",ref:c},[e("div",vl,[v[3]||(v[3]=e("h3",{class:"plugin-editor__title"},"添加插件",-1)),g(u(de),{class:"plugin-editor__close",onClick:o})]),e("div",gl,[e("div",_l,[v[4]||(v[4]=e("span",{class:"plugin-editor__add-type-label"},"添加方式",-1)),g(u(ne),{modelValue:x.value,"onUpdate:modelValue":v[0]||(v[0]=C=>x.value=C),type:"button",options:U},null,8,["modelValue"])]),x.value==="form"?(i(),d("div",fl,[g(pl,{"form-data":k.value,"onUpdate:formData":v[1]||(v[1]=C=>k.value=C)},null,8,["form-data"])])):b("",!0),x.value==="code"?(i(),d("div",hl,[g(al,{"code-data":_.value,"onUpdate:codeData":v[2]||(v[2]=C=>_.value=C)},null,8,["code-data"])])):b("",!0)]),e("div",{class:"plugin-editor__footer"},[e("div",{class:"button cancel",onClick:o},[...v[5]||(v[5]=[e("span",null,"取消",-1)])]),e("div",{class:"button confirm",onClick:f},[...v[6]||(v[6]=[e("span",null,"确定",-1)])])])],512)):b("",!0)]),_:1})],64))}}),bl=A(yl,[["__scopeId","data-v-192c66c9"]]),kl={class:"empty-state",role:"status","aria-live":"polite"},xl={key:1,src:Ue,class:"empty-state__illustration"},Tl={class:"empty-state__message"},Cl=I({__name:"NoData",props:{searchQuery:{default:""}},setup(m){const p=m,l=y(()=>{var c;return!!((c=p.searchQuery)!=null&&c.trim())}),n=y(()=>l.value?"暂无搜索结果":"暂无数据");return(c,k)=>(i(),d("section",kl,[l.value?(i(),w(u(Pe),{key:0,class:"empty-state__illustration"})):(i(),d("img",xl)),e("p",Tl,S(n.value),1)]))}}),se=A(Cl,[["__scopeId","data-v-839781e5"]]),wl={class:"mcp-server-picker__header"},Vl={class:"mcp-server-picker__header-left"},Bl={class:"mcp-server-picker__header-right"},Pl={class:"mcp-server-picker__content"},Ul={class:"mcp-server-picker__content-item"},Sl={key:0,class:"mcp-server-picker__content-installed-search"},Dl={key:1,class:"mcp-server-picker__content-installed-list"},Ml={key:0,class:"mcp-server-picker__loading"},Ll={key:0,class:"mcp-server-picker__content-market-header"},$l={key:0,style:{width:"168px"}},Fl={key:1,style:{width:"264px","flex-shrink":"0"}},Il={key:1,class:"mcp-server-picker__content-market-list"},Al={key:0,class:"mcp-server-picker__loading"},Rl=I({__name:"index",props:W({installedPlugins:{default:()=>[]},marketPlugins:{default:()=>[]},searchPlaceholder:{default:"搜索插件"},enableSearch:{type:Boolean,default:!0},installedSearchFn:{type:Function,default:(m,p)=>m?p.name.toLowerCase().includes(m.toLowerCase()):!0},marketSearchFn:{type:Function,default:(m,p)=>m?p.name.toLowerCase().includes(m.toLowerCase()):!0},marketCategoryOptions:{default:()=>[]},marketCategoryPlaceholder:{default:"按照分类筛选"},enableMarketCategoryFilter:{type:Boolean,default:!0},defaultActiveTab:{default:"installed"},showInstalledTab:{type:Boolean,default:!0},showMarketTab:{type:Boolean,default:!0},visible:{type:Boolean},popupConfig:{default:()=>({type:"fixed",position:{},drawer:{direction:"right"}})},activeCount:{},installedTabTitle:{default:"已添加插件"},marketTabTitle:{default:"市场"},title:{default:"插件"},showCustomAddButton:{type:Boolean,default:!0},customAddButtonText:{default:"自定义添加"},allowPluginToggle:{type:Boolean,default:!0},allowToolToggle:{type:Boolean,default:!0},allowPluginDelete:{type:Boolean,default:!0},allowPluginAdd:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},marketLoading:{type:Boolean,default:!1}},{visible:{type:Boolean,required:!0},visibleModifiers:{}}),emits:W(["market-category-change","tab-change","plugin-toggle","plugin-delete","plugin-add","plugin-create","tool-toggle","refresh","update:activeCount","update:visible"],["update:visible"]),setup(m,{emit:p}){const l=m,n=p,c=P(l.defaultActiveTab),k=P(""),_=P(""),x=P(""),U=y(()=>c.value==="installed"?l.searchPlaceholder:"搜索市场插件"),o=y(()=>l.installedPlugins),f=y(()=>l.marketPlugins),N=y(()=>!o.value||o.value.length===0?0:o.value.filter(a=>a.enabled).length);H(N,a=>{n("update:activeCount",a)},{immediate:!0}),H(c,(a,r)=>{a!==r&&n("tab-change",a)});const v=y(()=>o.value.filter(a=>l.installedSearchFn(k.value,a))),C=y(()=>{const{category:a,search:r}={category:x.value,search:_.value},h=t=>{const D=!a||t.category===a,M=!r||l.marketSearchFn(r,t);return D&&M};return f.value.filter(h)}),O=y(()=>c.value==="installed"?v.value.length>0:C.value.length>0);H(x,a=>{n("market-category-change",a)});const z=(a,r)=>{var h;l.allowPluginToggle&&(n("plugin-toggle",a,r),(h=a.tools)!=null&&h.length&&(r?a.tools.filter(t=>t.enabled).length===0&&a.tools.forEach(t=>{n("tool-toggle",a,t.id,!0)}):a.tools.forEach(t=>{t.enabled&&n("tool-toggle",a,t.id,!1)})))},s=(a,r,h)=>{var t;if(l.allowToolToggle&&(n("tool-toggle",a,r,h),(t=a.tools)!=null&&t.length)){const D=a.tools.filter(R=>R.id!==r).some(R=>R.enabled),M=h||D;a.enabled!==M&&n("plugin-toggle",a,M)}},T=a=>{l.allowPluginDelete&&(le.message({message:`${a.name} 已移除`,status:"success"}),n("plugin-delete",a))},V=(a,r)=>{l.allowPluginAdd&&(r&&le.message({message:`${a.name} 已添加`,status:"success"}),n("plugin-add",a,r))},L=P(!1),E=()=>{L.value=!0},Q=(a,r)=>{n("plugin-create",a,r),L.value=!1},ue=K(m,"visible"),ce=()=>{n("update:visible",!1)},pe=y(()=>{const{type:a,position:r,drawer:h}=l.popupConfig||{},t={"z-index":"1000",position:"fixed"};return a==="fixed"?{...t,...me(r)}:a==="drawer"?{...t,...ve(h)}:t}),me=(a={})=>{const r={};return Object.entries(a).forEach(([h,t])=>{t!==void 0&&(r[h]=typeof t=="number"?`${t}px`:t)}),Object.keys(r).length===0?{top:"50%",left:"50%",transform:"translate(-50%, -50%)"}:r},ve=(a={direction:"right"})=>{const{direction:r}=a,h={top:"0",bottom:"0",height:"100%"};return r==="left"?{...h,left:"0","border-right":"1px solid rgb(219, 219, 219)"}:{...h,right:"0","border-left":"1px solid rgb(219, 219, 219)"}},Z=y(()=>{const{type:a,drawer:r}=l.popupConfig||{};return a!=="drawer"?"":`drawer-${(r==null?void 0:r.direction)||"right"}`}),ge=y(()=>{const{type:a}=l.popupConfig||{};return a==="drawer"?Z.value:"fade"});return(a,r)=>(i(),w(Y,{name:ge.value},{default:B(()=>{var h;return[ue.value?(i(),d("div",{key:0,class:X(["mcp-server-picker",[`popup-type-${((h=l.popupConfig)==null?void 0:h.type)||"fixed"}`,Z.value]]),style:_e(pe.value)},[e("div",wl,[e("div",Vl,S(l.title),1),e("div",Bl,[l.showCustomAddButton?(i(),d("div",{key:0,class:"mcp-server-picker__header-right-item",onClick:E},[g(u(Ce),{style:{"font-size":"16px",cursor:"pointer"}}),e("span",null,S(l.customAddButtonText),1)])):b("",!0),g(u(de),{class:"mcp-server-picker__header-right-close",onClick:ce})])]),e("div",Pl,[g(u(Te),{modelValue:c.value,"onUpdate:modelValue":r[3]||(r[3]=t=>c.value=t)},{default:B(()=>[l.showInstalledTab?(i(),w(u(te),{key:0,title:l.installedTabTitle,name:"installed"},{default:B(()=>[e("div",Ul,[l.enableSearch?(i(),d("div",Sl,[g(u(ee),{modelValue:k.value,"onUpdate:modelValue":r[0]||(r[0]=t=>k.value=t),placeholder:l.searchPlaceholder},{suffix:B(()=>[g(u(oe),{style:{"font-size":"16px",cursor:"pointer"}})]),_:1},8,["modelValue","placeholder"])])):b("",!0),O.value?(i(),d("div",Dl,[l.loading?(i(),d("div",Ml,"加载中...")):(i(!0),d(F,{key:1},J(v.value,t=>{var D;return i(),w(u(ie),{key:t.id,plugin:t,mode:"installed",expandable:!!((D=t.tools)!=null&&D.length),onTogglePlugin:M=>z(t,M),onToggleTool:(M,R)=>s(t,M,R),onDeletePlugin:()=>T(t)},null,8,["plugin","expandable","onTogglePlugin","onToggleTool","onDeletePlugin"])}),128))])):(i(),w(u(se),{key:2,"search-query":k.value},null,8,["search-query"]))])]),_:1},8,["title"])):b("",!0),l.showMarketTab?(i(),w(u(te),{key:1,title:l.marketTabTitle,name:"market"},{default:B(()=>[l.enableSearch||l.enableMarketCategoryFilter?(i(),d("div",Ll,[l.enableMarketCategoryFilter?(i(),d("div",$l,[g(u(be),{modelValue:x.value,"onUpdate:modelValue":r[1]||(r[1]=t=>x.value=t),placeholder:l.marketCategoryPlaceholder},{default:B(()=>[(i(!0),d(F,null,J(l.marketCategoryOptions,t=>(i(),w(u(ke),{key:t.value,label:t.label,value:t.value},{default:B(()=>[fe(S(t.label),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])])):b("",!0),l.enableSearch?(i(),d("div",Fl,[g(u(ee),{modelValue:_.value,"onUpdate:modelValue":r[2]||(r[2]=t=>_.value=t),placeholder:U.value},{suffix:B(()=>[g(u(oe),{style:{"font-size":"16px",cursor:"pointer"}})]),_:1},8,["modelValue","placeholder"])])):b("",!0)])):b("",!0),O.value?(i(),d("div",Il,[l.marketLoading?(i(),d("div",Al,"加载中...")):(i(!0),d(F,{key:1},J(C.value,t=>(i(),w(u(ie),{key:t.id,plugin:t,mode:"market",expandable:!1,"show-tool-count":!1,onAddPlugin:D=>V(t,D)},null,8,["plugin","onAddPlugin"]))),128))])):(i(),w(u(se),{key:2,"search-query":_.value||x.value},null,8,["search-query"]))]),_:1},8,["title"])):b("",!0)]),_:1},8,["modelValue"])]),g(u(bl),{visible:L.value,"onUpdate:visible":r[4]||(r[4]=t=>L.value=t),onConfirm:Q},null,8,["visible"])],6)):b("",!0)]}),_:1},8,["name"]))}}),G=A(Rl,[["__scopeId","data-v-3db8e1e1"]]);G.name="McpServerPicker";const ql=function(m){m.component(G.name,G)};G.install=ql;export{G as J};
