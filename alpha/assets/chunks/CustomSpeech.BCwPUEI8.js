import{E as Je,x as je}from"./theme.FCGLGkiy.js";import{d as Ke,p as Le,c as _e,o as ye,e as Ee,j as ae,t as Ie,G as qe,k as Qe,F as Xe,B as Ye,a as Fe}from"./framework.CSeOnaMy.js";var $e={exports:{}};(function(X){(function(H){var C=typeof window=="object"&&!!window.document,Q=C?window:Object;H(Q,C),X.exports&&(X.exports=Q.Recorder)})(function(H,C){var Q=function(){},J=function(r){return typeof r=="number"},te=function(r){return JSON.stringify(r)},s=function(r){return new Pe(r)},d=s.LM="2025-01-11 09:28",K="https://github.com/xiangyuecn/Recorder",w="Recorder",z="getUserMedia",Y="srcSampleRate",L="sampleRate",ne="bitRate",ie="catch",oe=H[w];if(oe&&oe.LM==d){oe.CLog(oe.i18n.$T("K8zP::é‡å¤å¯¼å…¥{1}",0,w),3);return}s.IsOpen=function(){var r=s.Stream;if(r){var t=Ae(r),e=t[0];if(e){var n=e.readyState;return n=="live"||n==e.LIVE}}return!1},s.BufferSize=4096,s.Destroy=function(){E(w+" Destroy"),Se();for(var r in Ce)Ce[r]()};var Ce={};s.BindDestroy=function(r,t){Ce[r]=t},s.Support=function(){if(!C)return!1;var r=navigator.mediaDevices||{};return r[z]||(r=navigator,r[z]||(r[z]=r.webkitGetUserMedia||r.mozGetUserMedia||r.msGetUserMedia)),!(!r[z]||(s.Scope=r,!s.GetContext()))},s.GetContext=function(r){if(!C)return null;var t=window.AudioContext;if(t||(t=window.webkitAudioContext),!t)return null;var e=s.Ctx,n=0;return e||(e=s.Ctx=new t,n=1,s.NewCtxs=s.NewCtxs||[],s.BindDestroy("Ctx",function(){var a=s.Ctx;a&&a.close&&(fe(a),s.Ctx=0);var o=s.NewCtxs;s.NewCtxs=[];for(var i=0;i<o.length;i++)fe(o[i])})),r&&e.close&&(n||(e._useC||fe(e),e=new t),e._useC=1,s.NewCtxs.push(e)),e},s.CloseNewCtx=function(r){if(r&&r.close){fe(r);for(var t=s.NewCtxs||[],e=t.length,n=0;n<t.length;n++)if(t[n]==r){t.splice(n,1);break}E(f("mSxV::å‰©{1}ä¸ªGetContextæœªclose",0,e+"-1="+t.length),t.length?3:0)}};var fe=function(r){if(r&&r.close&&!r._isC&&(r._isC=1,r.state!="closed"))try{r.close()}catch(t){E("ctx close err",1,t)}},he=s.ResumeCtx=function(r,t,e,n){var a=0,o=0,i=0,g=0,l="EventListener",u="ResumeCtx ",S=function(y,v){o&&B(),a||(a=1,y&&n(y,g),v&&e(g)),v&&(!r._LsSC&&r["add"+l]&&r["add"+l]("statechange",m),r._LsSC=1,i=1)},B=function(y){if(!(y&&o)){o=y?1:0;for(var v=["focus","mousedown","mouseup","touchstart","touchend"],A=0;A<v.length;A++)window[(y?"add":"remove")+l](v[A],m,!0)}},m=function(){var y=r.state,v=ue(y);if(!a&&!t(v?++g:g))return S();v?(i&&E(u+"sc "+y,3),B(1),r.resume().then(function(){i&&E(u+"sc "+r.state),S(0,1)})[ie](function(A){E(u+"error",1,A),ue(r.state)||S(A.message||"error")})):y=="closed"?(i&&!r._isC&&E(u+"sc "+y,1),S("ctx closed")):S(0,1)};m()},ue=s.CtxSpEnd=function(r){return r=="suspended"||r=="interrupted"},we=function(r){var t=r.state,e="ctx.state="+t;return ue(t)&&(e+=f("nMIy::ï¼ˆæ³¨æ„ï¼šctxä¸æ˜¯runningçŠ¶æ€ï¼Œrec.openå’Œstartè‡³å°‘è¦æœ‰ä¸€ä¸ªåœ¨ç”¨æˆ·æ“ä½œ(è§¦æ‘¸ã€ç‚¹å‡»ç­‰)æ—¶è¿›è¡Œè°ƒç”¨ï¼Œå¦åˆ™å°†åœ¨rec.startæ—¶å°è¯•è¿›è¡Œctx.resumeï¼Œå¯èƒ½ä¼šäº§ç”Ÿå…¼å®¹æ€§é—®é¢˜(ä»…iOS)ï¼Œè¯·å‚é˜…æ–‡æ¡£ä¸­runningContexté…ç½®ï¼‰")),e},be="ConnectEnableWebM";s[be]=!0;var de="ConnectEnableWorklet";s[de]=!1;var Te=function(r){var t=r.BufferSize||s.BufferSize,e=r.Stream,n=e._c,a=n[L],o={},i=Ae(e),g=i[0],l=null,u="";if(g&&g.getSettings){l=g.getSettings();var S=l[L];S&&S!=a&&(u=f("eS8i::Streamçš„é‡‡æ ·ç‡{1}ä¸ç­‰äº{2}ï¼Œå°†è¿›è¡Œé‡‡æ ·ç‡è½¬æ¢ï¼ˆæ³¨æ„ï¼šéŸ³è´¨ä¸ä¼šå˜å¥½ç”šè‡³å¯èƒ½å˜å·®ï¼‰ï¼Œä¸»è¦åœ¨ç§»åŠ¨ç«¯æœªç¦ç”¨å›å£°æ¶ˆé™¤æ—¶ä¼šäº§ç”Ÿæ­¤ç°è±¡ï¼Œæµè§ˆå™¨æœ‰å›å£°æ¶ˆé™¤æ—¶å¯èƒ½åªä¼šè¿”å›16ké‡‡æ ·ç‡çš„éŸ³é¢‘æ•°æ®ï¼Œ",0,S,a))}e._ts=l,E(u+"Stream TrackSet: "+te(l),u?3:0);var B=function(T){var I=e._m=n.createMediaStreamSource(e),D=n.destination,$="createMediaStreamDestination";n[$]&&(D=e._d=n[$]()),I.connect(T),T.connect(D)},m,y,v,A="",O=e._call,x=function(T,I){for(var D in O){if(I!=a){o.index=0,o=s.SampleData([T],I,a,o,{_sum:1});var $=o.data,W=o._sum}else{o={};for(var R=T.length,$=new Int16Array(R),W=0,q=0;q<R;q++){var G=Math.max(-1,Math.min(1,T[q]));G=G<0?G*32768:G*32767,$[q]=G,W+=Math.abs(G)}}for(var V in O)O[V]($,W);return}},h="ScriptProcessor",b="audioWorklet",M=w+" "+b,N="RecProc",k="MediaRecorder",j=k+".WebM.PCM",p=n.createScriptProcessor||n.createJavaScriptNode,_=f("ZGlf::ã€‚ç”±äº{1}å†…éƒ¨1ç§’375æ¬¡å›è°ƒï¼Œåœ¨ç§»åŠ¨ç«¯å¯èƒ½ä¼šæœ‰æ€§èƒ½é—®é¢˜å¯¼è‡´å›è°ƒä¸¢å¤±å½•éŸ³å˜çŸ­ï¼ŒPCç«¯æ— å½±å“ï¼Œæš‚ä¸å»ºè®®å¼€å¯{1}ã€‚",0,b),c=function(){y=e.isWorklet=!1,Oe(e),E(f("7TU0::Connecté‡‡ç”¨è€çš„{1}ï¼Œ",0,h)+ee.get(s[de]?f("JwCL::ä½†å·²è®¾ç½®{1}å°è¯•å¯ç”¨{2}",2):f("VGjB::å¯è®¾ç½®{1}å°è¯•å¯ç”¨{2}",2),[w+"."+de+"=true",b])+A+_,3);var T=e._p=p.call(n,t,1,1);B(T),T.onaudioprocess=function(I){var D=I.inputBuffer.getChannelData(0);x(D,a)}},F=function(){m=e.isWebM=!1,De(e),y=e.isWorklet=!p||s[de];var T=window.AudioWorkletNode;if(!(y&&n[b]&&T)){c();return}var I=function(){var q=function(V){return V.toString().replace(/^function|DEL_/g,"").replace(/\$RA/g,M)},G="class "+N+" extends AudioWorkletProcessor{";return G+="constructor "+q(function(V){DEL_super(V);var re=this,P=V.processorOptions.bufferSize;re.bufferSize=P,re.buffer=new Float32Array(P*2),re.pos=0,re.port.onmessage=function(Z){Z.data.kill&&(re.kill=!0,$C.log("$RA kill call"))},$C.log("$RA .ctor call",V)}),G+="process "+q(function(V,re,P){var Z=this,me=Z.bufferSize,ce=Z.buffer,ve=Z.pos;if(V=(V[0]||[])[0]||[],V.length){ce.set(V,ve),ve+=V.length;var pe=~~(ve/me)*me;if(pe){this.port.postMessage({val:ce.slice(0,pe)});var ke=ce.subarray(pe,ve);ce=new Float32Array(me*2),ce.set(ke),ve=ke.length,Z.buffer=ce}Z.pos=ve}return!Z.kill}),G+='}try{registerProcessor("'+N+'", '+N+')}catch(e){$C.error("'+M+' Reg Error",e)}',G=G.replace(/\$C\./g,"console."),"data:text/javascript;base64,"+btoa(unescape(encodeURIComponent(G)))},D=function(){return y&&e._na},$=e._na=function(){v!==""&&(clearTimeout(v),v=setTimeout(function(){v=0,D()&&(E(f("MxX1::{1}æœªè¿”å›ä»»ä½•éŸ³é¢‘ï¼Œæ¢å¤ä½¿ç”¨{2}",0,b,h),3),p&&c())},500))},W=function(){if(D()){var q=e._n=new T(n,N,{processorOptions:{bufferSize:t}});B(q),q.port.onmessage=function(G){v&&(clearTimeout(v),v=""),D()?x(G.data.val,a):y||E(f("XUap::{1}å¤šä½™å›è°ƒ",0,b),3)},E(f("yOta::Connecté‡‡ç”¨{1}ï¼Œè®¾ç½®{2}å¯æ¢å¤è€å¼{3}",0,b,w+"."+de+"=false",h)+A+_,3)}},R=function(){if(D()){if(n[N]){W();return}var q=I();n[b].addModule(q).then(function(G){D()&&(n[N]=1,W(),v&&$())})[ie](function(G){E(b+".addModule Error",1,G),D()&&c()})}};he(n,function(){return D()},R,R)},U=function(){var T=window[k],I="ondataavailable",D="audio/webm; codecs=pcm";m=e.isWebM=s[be];var $=T&&I in T.prototype&&T.isTypeSupported(D);if(A=$?"":f("VwPd::ï¼ˆæ­¤æµè§ˆå™¨ä¸æ”¯æŒ{1}ï¼‰",0,j),!m||!$){F();return}var W=function(){return m&&e._ra};e._ra=function(){v!==""&&(clearTimeout(v),v=setTimeout(function(){W()&&(E(f("vHnb::{1}æœªè¿”å›ä»»ä½•éŸ³é¢‘ï¼Œé™çº§ä½¿ç”¨{2}",0,k,b),3),F())},500))};var R=Object.assign({mimeType:D},s.ConnectWebMOptions),q=e._r=new T(e,R),G=e._rd={};q[I]=function(V){var re=new FileReader;re.onloadend=function(){if(W()){var P=He(new Uint8Array(re.result),G);if(!P)return;if(P==-1){F();return}v&&(clearTimeout(v),v=""),x(P,G.webmSR)}else m||E(f("O9P7::{1}å¤šä½™å›è°ƒ",0,k),3)},re.readAsArrayBuffer(V.data)};try{q.start(~~(t/48)),E(f("LMEm::Connecté‡‡ç”¨{1}ï¼Œè®¾ç½®{2}å¯æ¢å¤ä½¿ç”¨{3}æˆ–è€å¼{4}",0,j,w+"."+be+"=false",b,h))}catch(V){E("mr start err",1,V),F()}};U()},ze=function(r){r._na&&r._na(),r._ra&&r._ra()},Oe=function(r){r._na=null,r._n&&(r._n.port.postMessage({kill:!0}),r._n.disconnect(),r._n=null)},De=function(r){if(r._ra=null,r._r){try{r._r.stop()}catch(t){E("mr stop err",1,t)}r._r=null}},Se=function(r){r=r||s;var t=r==s,e=r.Stream;e&&(e._m&&(e._m.disconnect(),e._m=null),!e._RC&&e._c&&s.CloseNewCtx(e._c),e._RC=null,e._c=null,e._d&&(Re(e._d.stream),e._d=null),e._p&&(e._p.disconnect(),e._p.onaudioprocess=e._p=null),Oe(e),De(e),t&&Re(e)),r.Stream=0},Re=s.StopS_=function(r){for(var t=Ae(r),e=0;e<t.length;e++){var n=t[e];n.stop&&n.stop()}r.stop&&r.stop()},Ae=function(r){var t=0,e=0,n=[];r.getAudioTracks&&(t=r.getAudioTracks(),e=r.getVideoTracks()),t||(t=r.audioTracks,e=r.videoTracks);for(var a=0,o=t?t.length:0;a<o;a++)n.push(t[a]);for(var a=0,o=e?e.length:0;a<o;a++)n.push(e[a]);return n};s.SampleData=function(r,t,e,n,a){var o="SampleData";n||(n={});var i=n.index||0,g=n.offset||0,l=n.raisePrev||0,u=n.filter;if(u&&u.fn&&(u.sr&&u.sr!=t||u.srn&&u.srn!=e)&&(u=null,E(f("d48C::{1}çš„filteré‡‡æ ·ç‡å˜äº†ï¼Œé‡è®¾æ»¤æ³¢",0,o),3)),!u)if(e<=t){var S=e>t*3/4?0:e/2*3/4;u={fn:S?s.IIRFilter(!0,t,S):0}}else{var S=t>e*3/4?0:t/2*3/4;u={fn:S?s.IIRFilter(!0,e,S):0}}u.sr=t,u.srn=e;var B=u.fn,m=n.frameNext||[];a||(a={});var y=a.frameSize||1;a.frameType&&(y=a.frameType=="mp3"?1152:1);var v=a._sum,A=0,O=r.length;i>O+1&&E(f("tlbC::{1}ä¼¼ä¹ä¼ å…¥äº†æœªé‡ç½®chunk {2}",0,o,i+">"+O),3);for(var x=0,h=i;h<O;h++)x+=r[h].length;var b=t/e;if(b>1)x=Math.max(0,x-Math.floor(g)),x=Math.floor(x/b);else if(b<1){var M=1/b;x=Math.floor(x*M)}x+=m.length;for(var N=new Int16Array(x),k=0,h=0;h<m.length;h++)N[k]=m[h],k++;for(;i<O;i++){var j=r[i],p=j instanceof Float32Array,h=g,_=j.length,c=B&&B.Embed,F=0,U=0,T=0,I=0;if(b<1){for(var D=k+h,$=l,W=0;W<_;W++){var R=j[W];p&&(R=Math.max(-1,Math.min(1,R)),R=R<0?R*32768:R*32767);var q=Math.floor(D);D+=M;for(var G=Math.floor(D),V=(R-$)/(G-q),re=1;q<G;q++,re++){var P=Math.floor($+re*V);c?(T=P,I=c.b0*T+c.b1*c.x1+c.b0*c.x2-c.a1*c.y1-c.a2*c.y2,c.x2=c.x1,c.x1=T,c.y2=c.y1,c.y1=I,P=I):P=B?B(P):P,P>32767?P=32767:P<-32768&&(P=-32768),v&&(A+=Math.abs(P)),N[q]=P,k++}$=l=R,h+=M}g=h%1;continue}for(var W=0,Z=0;W<_;W++,Z++){if(Z<_){var R=j[Z];p&&(R=Math.max(-1,Math.min(1,R)),R=R<0?R*32768:R*32767),c?(T=R,I=c.b0*T+c.b1*c.x1+c.b0*c.x2-c.a1*c.y1-c.a2*c.y2,c.x2=c.x1,c.x1=T,c.y2=c.y1,c.y1=I):I=B?B(R):R}if(F=U,U=I,Z==0){W--;continue}var me=Math.floor(h);if(W==me){var ce=Math.ceil(h),ve=h-me,pe=F,ke=ce<_?U:pe,xe=pe+(ke-pe)*ve;xe>32767?xe=32767:xe<-32768&&(xe=-32768),v&&(A+=Math.abs(xe)),N[k]=xe,k++,h+=b}}g=Math.max(0,h-_)}b<1&&k+1==x&&(x--,N=new Int16Array(N.buffer.slice(0,x*2))),k-1!=x&&k!=x&&E(o+" idx:"+k+" != size:"+x,3),m=null;var Ue=x%y;if(Ue>0){var We=(x-Ue)*2;m=new Int16Array(N.buffer.slice(We)),N=new Int16Array(N.buffer.slice(0,We))}var Ge={index:i,offset:g,raisePrev:l,filter:u,frameNext:m,sampleRate:e,data:N};return v&&(Ge._sum=A),Ge},s.IIRFilter=function(r,t,e){var n=2*Math.PI*e/t,a=Math.sin(n),o=Math.cos(n),i=a/2,g=1+i,l=-2*o/g,u=(1-i)/g;if(r)var S=(1-o)/2/g,B=(1-o)/g;else var S=(1+o)/2/g,B=-(1+o)/g;var m=0,y=0,v=0,A=0,O=0,x=function(h){return v=S*h+B*m+S*y-l*A-u*O,y=m,m=h,O=A,A=v,v};return x.Embed={x1:0,x2:0,y1:0,y2:0,b0:S,b1:B,a1:l,a2:u},x},s.PowerLevel=function(r,t){var e=r/t||0,n;return e<1251?n=Math.round(e/1250*10):n=Math.round(Math.min(100,Math.max(0,(1+Math.log(e/1e4)/Math.log(10))*100))),n},s.PowerDBFS=function(r){var t=Math.max(.1,r||0),e=32767;return t=Math.min(t,e),t=20*Math.log(t/e)/Math.log(10),Math.max(-100,Math.round(t))},s.CLog=function(r,t){if(typeof console=="object"){var e=new Date,n=("0"+e.getMinutes()).substr(-2)+":"+("0"+e.getSeconds()).substr(-2)+"."+("00"+e.getMilliseconds()).substr(-3),a=this&&this.envIn&&this.envCheck&&this.id,o=["["+n+" "+w+(a?":"+a:"")+"]"+r],i=arguments,g=s.CLog,l=2,u=g.log||console.log;for(J(t)?u=t==1?g.error||console.error:t==3?g.warn||console.warn:u:l=1;l<i.length;l++)o.push(i[l]);Ne?u&&u("[IsLoser]"+o[0],o.length>1?o:""):u.apply(console,o)}};var E=function(){s.CLog.apply(this,arguments)},Ne=!0;try{Ne=!console.log.apply}catch{}var Ve=0;function Pe(r){var t=this;t.id=++Ve,Be();var e={type:"mp3",onProcess:Q};for(var n in r)e[n]=r[n];t.set=e;var a=e[ne],o=e[L];(a&&!J(a)||o&&!J(o))&&t.CLog(f.G("IllegalArgs-1",[f("VtS4::{1}å’Œ{2}å¿…é¡»æ˜¯æ•°å€¼",0,L,ne)]),1,r),e[ne]=+a||16,e[L]=+o||16e3,t.state=0,t._S=9,t.Sync={O:9,C:9}}s.Sync={O:9,C:9},s.prototype=Pe.prototype={CLog:E,_streamStore:function(){return this.set.sourceStream?this:s},_streamGet:function(){return this._streamStore().Stream},_streamCtx:function(){var r=this._streamGet();return r&&r._c},open:function(r,t){var e=this,n=e.set,a=e._streamStore(),o=0;r=r||Q;var i=function(p,_){_=!!_,e.CLog(f("5tWi::å½•éŸ³openå¤±è´¥ï¼š")+p+",isUserNotAllow:"+_,1),o&&s.CloseNewCtx(o),t&&t(p,_)};e._streamTag=z;var g=function(){e.CLog("open ok, id:"+e.id+" stream:"+e._streamTag),r(),e._SO=0},l=a.Sync,u=++l.O,S=l.C;e._O=e._O_=u,e._SO=e._S;var B=function(){if(S!=l.C||!e._O){var p=f("dFm8::openè¢«å–æ¶ˆ");return u==l.O?e.close():p=f("VtJO::openè¢«ä¸­æ–­"),i(p),!0}};if(!C){i(f.G("NonBrowser-1",["open"])+f("EMJq::ï¼Œå¯å°è¯•ä½¿ç”¨RecordAppè§£å†³æ–¹æ¡ˆ")+"("+K+"/tree/master/app-support-sample)");return}var m=e.envCheck({envName:"H5",canProcess:!0});if(m){i(f("A5bm::ä¸èƒ½å½•éŸ³ï¼š")+m);return}var y,v=function(){y=n.runningContext,y||(y=o=s.GetContext(!0))};if(n.sourceStream){if(e._streamTag="set.sourceStream",!s.GetContext()){i(f("1iU7::ä¸æ”¯æŒæ­¤æµè§ˆå™¨ä»æµä¸­è·å–å½•éŸ³"));return}v(),Se(a);var A=e.Stream=n.sourceStream;A._c=y,A._RC=n.runningContext,A._call={};try{Te(a)}catch(p){Se(a),i(f("BTW2::ä»æµä¸­æ‰“å¼€å½•éŸ³å¤±è´¥ï¼š")+p.message);return}g();return}var O=function(p,_){try{window.top.a}catch{i(f("Nclz::æ— æƒå½•éŸ³(è·¨åŸŸï¼Œè¯·å°è¯•ç»™iframeæ·»åŠ éº¦å…‹é£è®¿é—®ç­–ç•¥ï¼Œå¦‚{1})",0,'allow="camera;microphone"'));return}x(1,p)&&(/Found/i.test(p)?i(_+f("jBa9::ï¼Œæ— å¯ç”¨éº¦å…‹é£")):i(_))},x=function(p,_){if(/Permission|Allow/i.test(_))p&&i(f("gyO5::ç”¨æˆ·æ‹’ç»äº†å½•éŸ³æƒé™"),!0);else if(window.isSecureContext===!1)p&&i(f("oWNo::æµè§ˆå™¨ç¦æ­¢ä¸å®‰å…¨é¡µé¢å½•éŸ³ï¼Œå¯å¼€å¯httpsè§£å†³"));else return 1};if(s.IsOpen()){g();return}if(!s.Support()){O("",f("COxc::æ­¤æµè§ˆå™¨ä¸æ”¯æŒå½•éŸ³"));return}v();var h=function(p){setTimeout(function(){p._call={};var _=s.Stream;_&&(Se(),p._call=_._call),s.Stream=p,p._c=y,p._RC=n.runningContext,!B()&&(s.IsOpen()?(_&&e.CLog(f("upb8::å‘ç°åŒæ—¶å¤šæ¬¡è°ƒç”¨open"),1),Te(a),g()):i(f("Q1GA::å½•éŸ³åŠŸèƒ½æ— æ•ˆï¼šæ— éŸ³é¢‘æµ")))},100)},b=function(p){var _=p.name||p.message||p.code+":"+p,c="";M==1&&x(0,_)&&(c=f("KxE2::ï¼Œå°†å°è¯•ç¦ç”¨å›å£°æ¶ˆé™¤åé‡è¯•"));var F=f("xEQR::è¯·æ±‚å½•éŸ³æƒé™é”™è¯¯"),U=f("bDOG::æ— æ³•å½•éŸ³ï¼š");e.CLog(F+c+"|"+p,c||k?3:1,p),c?(N=_,k=p,j(1)):k?(e.CLog(F+"|"+k,1,k),O(N,U+k)):O(_,U+p)},M=0,N,k,j=function(p){M++;var _="audioTrackSet",c="autoGainControl",F="echoCancellation",U="noiseSuppression",T=_+":{"+F+","+U+","+c+"}",I=JSON.parse(te(n[_]||!0));e.CLog("open... "+M+" "+_+":"+te(I)),p&&(typeof I!="object"&&(I={}),I[c]=!1,I[F]=!1,I[U]=!1),I[L]&&e.CLog(f("IjL3::æ³¨æ„ï¼šå·²é…ç½®{1}å‚æ•°ï¼Œå¯èƒ½ä¼šå‡ºç°æµè§ˆå™¨ä¸èƒ½æ­£ç¡®é€‰ç”¨éº¦å…‹é£ã€ç§»åŠ¨ç«¯æ— æ³•å¯ç”¨å›å£°æ¶ˆé™¤ç­‰ç°è±¡",0,_+"."+L),3);var D={audio:I,video:n.videoTrackSet||!1};try{var $=s.Scope[z](D,h,b)}catch(W){e.CLog(z,3,W),D={audio:!0,video:!1},$=s.Scope[z](D,h,b)}e.CLog(z+"("+te(D)+") "+we(y)+f("RiWe::ï¼Œæœªé…ç½® {1} æ—¶æµè§ˆå™¨å¯èƒ½ä¼šè‡ªåŠ¨å¯ç”¨å›å£°æ¶ˆé™¤ï¼Œç§»åŠ¨ç«¯æœªç¦ç”¨å›å£°æ¶ˆé™¤æ—¶å¯èƒ½ä¼šé™ä½ç³»ç»Ÿæ’­æ”¾éŸ³é‡ï¼ˆå…³é—­å½•éŸ³åå¯æ¢å¤ï¼‰å’Œä»…æä¾›16ké‡‡æ ·ç‡çš„éŸ³é¢‘æµï¼ˆä¸éœ€è¦å›å£°æ¶ˆé™¤æ—¶å¯æ˜ç¡®é…ç½®æˆç¦ç”¨æ¥è·å¾—48ké«˜éŸ³è´¨çš„æµï¼‰ï¼Œè¯·å‚é˜…æ–‡æ¡£ä¸­{2}é…ç½®",0,T,_)+"("+K+") LM:"+d+" UA:"+navigator.userAgent),$&&$.then&&$.then(h)[ie](b)};j()},close:function(r){r=r||Q;var t=this,e=t._streamStore();t._stop();var n=" stream:"+t._streamTag,a=e.Sync;if(t._O=0,t._O_!=a.O){t.CLog(f("hWVz::closeè¢«å¿½ç•¥ï¼ˆå› ä¸ºåŒæ—¶openäº†å¤šä¸ªrecï¼Œåªæœ‰æœ€åä¸€ä¸ªä¼šçœŸæ­£closeï¼‰")+n,3),r();return}a.C++,Se(e),t.CLog("close,"+n),r()},mock:function(r,t){var e=this;return e._stop(),e.isMock=1,e.mockEnvInfo=null,e.buffers=[r],e.recSize=r.length,e._setSrcSR(t),e._streamTag="mock",e},_setSrcSR:function(r){var t=this,e=t.set,n=e[L];n>r?e[L]=r:n=0,t[Y]=r,t.CLog(Y+": "+r+" set."+L+": "+e[L]+(n?" "+f("UHvm::å¿½ç•¥")+": "+n:""),n?3:0)},envCheck:function(r){var t,e=this,n=e.set,a="CPU_BE";if(!t&&!s[a]&&typeof Int8Array=="function"&&!new Int8Array(new Int32Array([1]).buffer)[0]&&(Be(a),t=f("Essp::ä¸æ”¯æŒ{1}æ¶æ„",0,a)),!t){var o=n.type,i=e[o+"_envCheck"];n.takeoffEncodeChunk&&(i?r.canProcess||(t=f("7uMV::{1}ç¯å¢ƒä¸æ”¯æŒå®æ—¶å¤„ç†",0,r.envName)):t=f("2XBl::{1}ç±»å‹ä¸æ”¯æŒè®¾ç½®takeoffEncodeChunk",0,o)+(e[o]?"":f("LG7e::(æœªåŠ è½½ç¼–ç å™¨)"))),!t&&i&&(t=e[o+"_envCheck"](r,n))}return t||""},envStart:function(r,t){var e=this,n=e.set;if(e.isMock=r?1:0,e.mockEnvInfo=r,e.buffers=[],e.recSize=0,r&&(e._streamTag="env$"+r.envName),e.state=1,e.envInLast=0,e.envInFirst=0,e.envInFix=0,e.envInFixTs=[],e._setSrcSR(t),e.engineCtx=0,e[n.type+"_start"]){var a=e.engineCtx=e[n.type+"_start"](n);a&&(a.pcmDatas=[],a.pcmSize=0)}},envResume:function(){this.envInFixTs=[]},envIn:function(r,t){var e=this,n=e.set,a=e.engineCtx;if(e.state!=1){e.state||e.CLog("envIn at state=0",3);return}var o=e[Y],i=r.length,g=s.PowerLevel(t,i),l=e.buffers,u=l.length;l.push(r);var S=l,B=u,m=Date.now(),y=Math.round(i/o*1e3);e.envInLast=m,e.buffers.length==1&&(e.envInFirst=m-y);var v=e.envInFixTs;v.splice(0,0,{t:m,d:y});for(var A=m,O=0,x=0;x<v.length;x++){var h=v[x];if(m-h.t>3e3){v.length=x;break}A=h.t,O+=h.d}var b=v[1],M=m-A,N=M-O;if(N>M/3&&(b&&M>1e3||v.length>=6)){var k=m-b.t-y;if(k>y/5){var j=!n.disableEnvInFix;if(e.CLog("["+m+"]"+ee.get(f(j?"4Kfd::è¡¥å¿{1}ms":"bM5i::æœªè¡¥å¿{1}ms",1),[k]),3),e.envInFix+=k,j){var p=new Int16Array(k*o/1e3);i+=p.length,l.push(p)}}}var _=e.recSize,c=i,F=_+c;if(e.recSize=F,a){var U=s.SampleData(l,o,n[L],a.chunkInfo);a.chunkInfo=U,_=a.pcmSize,c=U.data.length,F=_+c,a.pcmSize=F,l=a.pcmDatas,u=l.length,l.push(U.data),o=U[L]}var T=Math.round(F/o*1e3),I=l.length,D=S.length,$=function(){for(var V=W?0:-c,re=l[0]==null,P=u;P<I;P++){var Z=l[P];Z==null?re=1:(V+=Z.length,a&&Z.length&&e[n.type+"_encode"](a,Z))}if(re&&a){var P=B;for(S[0]&&(P=0);P<D;P++)S[P]=null}re&&(V=W?c:0,l[0]=null),a?a.pcmSize+=V:e.recSize+=V},W=0,R="rec.set.onProcess";try{W=n.onProcess(l,g,T,o,u,$),W=W===!0}catch(V){console.error(R+f("gFUF::å›è°ƒå‡ºé”™æ˜¯ä¸å…è®¸çš„ï¼Œéœ€ä¿è¯ä¸ä¼šæŠ›å¼‚å¸¸"),V)}var q=Date.now()-m;if(q>10&&e.envInFirst-m>1e3&&e.CLog(R+f("2ghS::ä½æ€§èƒ½ï¼Œè€—æ—¶{1}ms",0,q),3),W){for(var G=0,x=u;x<I;x++)l[x]==null?G=1:l[x]=new Int16Array(0);G?e.CLog(f("ufqH::æœªè¿›å…¥å¼‚æ­¥å‰ä¸èƒ½æ¸…é™¤buffers"),3):a?a.pcmSize-=c:e.recSize-=c}else $()},start:function(){var r=this,t=1;if(r.set.sourceStream?r.Stream||(t=0):s.IsOpen()||(t=0),!t){r.CLog(f("6WmN::startå¤±è´¥ï¼šæœªopen"),1);return}var e=r._streamCtx();if(r.CLog(f("kLDN::start å¼€å§‹å½•éŸ³ï¼Œ")+we(e)+" stream:"+r._streamTag),r._stop(),r.envStart(null,e[L]),r.state=3,r._SO&&r._SO+1!=r._S){r.CLog(f("Bp2y::startè¢«ä¸­æ–­"),3);return}r._SO=0;var n=function(){r.state==3&&(r.state=1,r.resume())},a="AudioContext resume: ",o=r._streamGet();o._call[r.id]=function(){r.CLog(a+e.state+"|stream ok"),n()},he(e,function(i){return i&&r.CLog(a+"wait..."),r.state==3},function(i){i&&r.CLog(a+e.state),n()},function(i){r.CLog(a+e.state+f("upkE::ï¼Œå¯èƒ½æ— æ³•å½•éŸ³ï¼š")+i,1),n()})},pause:function(){var r=this,t=r._streamGet();r.state&&(r.state=2,r.CLog("pause"),t&&delete t._call[r.id])},resume:function(){var r=this,t=r._streamGet(),e="resume",n=e+"(wait ctx)";if(r.state==3)r.CLog(n);else if(r.state){r.state=1,r.CLog(e),r.envResume(),t&&(t._call[r.id]=function(o,i){r.state==1&&r.envIn(o,i)},ze(t));var a=r._streamCtx();a&&he(a,function(o){return o&&r.CLog(n+"..."),r.state==1},function(o){o&&r.CLog(n+a.state),ze(t)},function(o){r.CLog(n+a.state+"[err]"+o,1)})}},_stop:function(r){var t=this,e=t.set;t.isMock||t._S++,t.state&&(t.pause(),t.state=0),!r&&t[e.type+"_stop"]&&(t[e.type+"_stop"](t.engineCtx),t.engineCtx=0)},stop:function(r,t,e){var n=this,a=n.set,o,i=n.envInLast-n.envInFirst,g=i&&n.buffers.length;n.CLog(f("Xq4s::stop å’Œstartæ—¶å·®:")+(i?i+"ms "+f("3CQP::è¡¥å¿:")+n.envInFix+"ms envIn:"+g+" fps:"+(g/i*1e3).toFixed(1):"-")+" stream:"+n._streamTag+" ("+K+") LM:"+d);var l=function(){n._stop(),e&&n.close()},u=function(h){n.CLog(f("u8JG::ç»“æŸå½•éŸ³å¤±è´¥ï¼š")+h,1),t&&t(h),l()},S=function(h,b,M){var N="blob",k="arraybuffer",j="dataType",p="DefaultDataType",_=n[j]||s[p]||N,c=j+"="+_,F=h instanceof ArrayBuffer,U=0,T=F?h.byteLength:h.size;if(_==k?F||(U=1):_==N?typeof Blob!="function"?U=f.G("NonBrowser-1",[c])+f("1skY::ï¼Œè¯·è®¾ç½®{1}",0,w+"."+p+'="'+k+'"'):(F&&(h=new Blob([h],{type:b})),h instanceof Blob||(U=1),b=h.type||b):U=f.G("NotSupport-1",[c]),n.CLog(f("Wv7l::ç»“æŸå½•éŸ³ ç¼–ç èŠ±{1}ms éŸ³é¢‘æ—¶é•¿{2}ms æ–‡ä»¶å¤§å°{3}b",0,Date.now()-o,M,T)+" "+c+","+b),U){u(U!=1?U:f("Vkbd::{1}ç¼–ç å™¨è¿”å›çš„ä¸æ˜¯{2}",0,a.type,_)+", "+c);return}if(a.takeoffEncodeChunk)n.CLog(f("QWnr::å¯ç”¨takeoffEncodeChunkåstopè¿”å›çš„blobé•¿åº¦ä¸º0ä¸æä¾›éŸ³é¢‘æ•°æ®"),3);else if(T<Math.max(50,M/5)){u(f("Sz2H::ç”Ÿæˆçš„{1}æ— æ•ˆ",0,a.type));return}r&&r(h,M,b),l()};if(!n.isMock){var B=n.state==3;if(!n.state||B){u(f("wf9t::æœªå¼€å§‹å½•éŸ³")+(B?f("Dl2c::ï¼Œå¼€å§‹å½•éŸ³å‰æ— ç”¨æˆ·äº¤äº’å¯¼è‡´AudioContextæœªè¿è¡Œ"):""));return}}n._stop(!0);var m=n.recSize;if(!m){u(f("Ltz3::æœªé‡‡é›†åˆ°å½•éŸ³"));return}if(!n[a.type]){u(f("xGuI::æœªåŠ è½½{1}ç¼–ç å™¨ï¼Œè¯·å°è¯•åˆ°{2}çš„src/engineå†…æ‰¾åˆ°{1}çš„ç¼–ç å™¨å¹¶åŠ è½½",0,a.type,w));return}if(n.isMock){var y=n.envCheck(n.mockEnvInfo||{envName:"mock",canProcess:!1});if(y){u(f("AxOH::å½•éŸ³é”™è¯¯ï¼š")+y);return}}var v=n.engineCtx;if(n[a.type+"_complete"]&&v){var x=Math.round(v.pcmSize/a[L]*1e3);o=Date.now(),n[a.type+"_complete"](v,function(b,M){S(b,M,x)},u);return}if(o=Date.now(),!n.buffers[0]){u(f("xkKd::éŸ³é¢‘buffersè¢«é‡Šæ”¾"));return}var A=s.SampleData(n.buffers,n[Y],a[L]);a[L]=A[L];var O=A.data,x=Math.round(O.length/a[L]*1e3);n.CLog(f("CxeT::é‡‡æ ·:{1} èŠ±:{2}ms",0,m+"->"+O.length,Date.now()-o)),setTimeout(function(){o=Date.now(),n[a.type](O,function(h,b){S(h,b,x)},function(h){u(h)})})}};var He=function(r,t){t.pos||(t.pos=[0],t.tracks={},t.bytes=[]);var e=t.tracks,n=[t.pos[0]],a=function(){t.pos[0]=n[0]},o=t.bytes.length,i=new Uint8Array(o+r.length);if(i.set(t.bytes),i.set(r,o),t.bytes=i,!t._ht){if(le(i,n),ge(i,n),!se(le(i,n),[24,83,128,103]))return;for(le(i,n);n[0]<i.length;){var g=le(i,n),l=ge(i,n),u=[0],S=0;if(!l)return;if(se(g,[22,84,174,107])){for(;u[0]<l.length;){var B=le(l,u),m=ge(l,u),y=[0],v={channels:0,sampleRate:0};if(se(B,[174]))for(;y[0]<m.length;){var A=le(m,y),O=ge(m,y),x=[0];if(se(A,[215])){var h=Me(O);v.number=h,e[h]=v}else if(se(A,[131])){var h=Me(O);h==1?v.type="video":h==2?(v.type="audio",S||(t.track0=v),v.idx=S++):v.type="Type-"+h}else if(se(A,[134])){for(var b="",M=0;M<O.length;M++)b+=String.fromCharCode(O[M]);v.codec=b}else if(se(A,[225]))for(;x[0]<O.length;){var N=le(O,x),k=ge(O,x);if(se(N,[181])){var h=0,j=new Uint8Array(k.reverse()).buffer;k.length==4?h=new Float32Array(j)[0]:k.length==8?h=new Float64Array(j)[0]:E("WebM Track !Float",1,k),v[L]=Math.round(h)}else se(N,[98,100])?v.bitDepth=Me(k):se(N,[159])&&(v.channels=Me(k))}}}t._ht=1,E("WebM Tracks",e),a();break}}}var p=t.track0;if(p){var _=p[L];if(t.webmSR=_,p.bitDepth==16&&/FLOAT/i.test(p.codec)&&(p.bitDepth=32,E("WebM 16->32 bit",3)),_<8e3||p.bitDepth!=32||p.channels<1||!/(\b|_)PCM\b/i.test(p.codec))return t.bytes=[],t.bad||E("WebM Track Unexpected",3,t),t.bad=1,-1;for(var c=[],F=0;n[0]<i.length;){var B=le(i,n),m=ge(i,n);if(!m)break;if(se(B,[163])){var U=m[0]&15,v=e[U];if(v){if(v.idx===0){for(var T=new Uint8Array(m.length-4),M=4;M<m.length;M++)T[M-4]=m[M];c.push(T),F+=T.length}}else return E("WebM !Track"+U,1,e),-1}a()}if(F){var I=new Uint8Array(i.length-t.pos[0]);I.set(i.subarray(t.pos[0])),t.bytes=I,t.pos[0]=0;for(var T=new Uint8Array(F),M=0,D=0;M<c.length;M++)T.set(c[M],D),D+=c[M].length;var j=new Float32Array(T.buffer);if(p.channels>1){for(var $=[],M=0;M<j.length;)$.push(j[M]),M+=p.channels;j=new Float32Array($)}return j}}},se=function(r,t){if(!r||r.length!=t.length)return!1;if(r.length==1)return r[0]==t[0];for(var e=0;e<r.length;e++)if(r[e]!=t[e])return!1;return!0},Me=function(r){for(var t="",e=0;e<r.length;e++){var n=r[e];t+=(n<16?"0":"")+n.toString(16)}return parseInt(t,16)||0},le=function(r,t,e){var n=t[0];if(!(n>=r.length)){var a=r[n],o=("0000000"+a.toString(2)).substr(-8),i=/^(0*1)(\d*)$/.exec(o);if(i){var g=i[1].length,l=[];if(!(n+g>r.length)){for(var u=0;u<g;u++)l[u]=r[n],n++;return e&&(l[0]=parseInt(i[2]||"0",2)),t[0]=n,l}}}},ge=function(r,t){var e=le(r,t,1);if(e){var n=Me(e),a=t[0],o=[];if(n<2147483647){if(a+n>r.length)return;for(var i=0;i<n;i++)o[i]=r[a],a++}return t[0]=a,o}},ee=s.i18n={lang:"zh-CN",alias:{"zh-CN":"zh","en-US":"en"},locales:{},data:{},put:function(r,t){var e=w+".i18n.put: ",n=r.overwrite;n=n==null||n;var a=r.lang;if(a=ee.alias[a]||a,!a)throw new Error(e+"set.lang?");var o=ee.locales[a];o||(o={},ee.locales[a]=o);for(var i=/^([\w\-]+):/,g,l=0;l<t.length;l++){var S=t[l];if(g=i.exec(S),!g){E(e+"'key:'? "+S,3,r);continue}var u=g[1],S=S.substr(u.length+1);!n&&o[u]||(o[u]=S)}},get:function(){return ee.v_G.apply(null,arguments)},v_G:function(r,t,e){t=t||[],e=e||ee.lang,e=ee.alias[e]||e;var n=ee.locales[e],a=n&&n[r]||"";return!a&&e!="zh"?e=="en"?ee.v_G(r,t,"zh"):ee.v_G(r,t,"en"):(ee.lastLang=e,a=="=Empty"?"":a.replace(/\{(\d+)(\!?)\}/g,function(o,i,g){return i=+i||0,o=t[i-1],(i<1||i>t.length)&&(o="{?}",E("i18n["+r+"] no {"+i+"}: "+a,3)),g?"":o}))},$T:function(){return ee.v_T.apply(null,arguments)},v_T:function(){for(var r=arguments,t="",e=[],n=0,a=w+".i18n.$T:",o=/^([\w\-]*):/,i,g=0;g<r.length;g++){var l=r[g];if(g==0){if(i=o.exec(l),t=i&&i[1],!t)throw new Error(a+"0 'key:'?");l=l.substr(t.length+1)}if(n===-1)e.push(l);else{if(n)throw new Error(a+" bad args");if(l===0)n=-1;else if(J(l)){if(l<1)throw new Error(a+" bad args");n=l}else{var u=g==1?"en":g?"":"zh";if(i=o.exec(l),i&&(u=i[1]||u,l=l.substr(i[1].length+1)),!i||!u)throw new Error(a+g+" 'lang:'?");ee.put({lang:u,overwrite:!1},[t+":"+l])}}}return t?n>0?t:ee.v_G(t,e):""}},f=ee.$T;f.G=ee.get,f("NonBrowser-1::éæµè§ˆå™¨ç¯å¢ƒï¼Œä¸æ”¯æŒ{1}",1),f("IllegalArgs-1::å‚æ•°é”™è¯¯ï¼š{1}",1),f("NeedImport-2::è°ƒç”¨{1}éœ€è¦å…ˆå¯¼å…¥{2}",2),f("NotSupport-1::ä¸æ”¯æŒï¼š{1}",1),s.TrafficImgUrl="//ia.51.la/go1?id=20469973&pvFlag=1";var Be=s.Traffic=function(r){if(C){r=r?"/"+w+"/Report/"+r:"";var t=s.TrafficImgUrl;if(t){var e=s.Traffic,n=/^(https?:..[^\/#]*\/?)[^#]*/i.exec(location.href)||[],a=n[1]||"http://file/",o=(n[0]||a)+r;if(t.indexOf("//")==0&&(/^https:/i.test(o)?t="https:"+t:t="http:"+t),r&&(t=t+"&cu="+encodeURIComponent(a+r)),!e[o]){e[o]=1;var i=new Image;i.src=t,E("Traffic Analysis Image: "+(r||w+".TrafficImgUrl="+s.TrafficImgUrl))}}}};oe&&(E(f("8HO5::è¦†ç›–å¯¼å…¥{1}",0,w),1),oe.Destroy()),H[w]=s})})($e);var Ze=$e.exports;const er=Je(Ze);(function(X){var H=typeof window=="object"&&!!window.document,C=H?window:Object,Q=C.Recorder,J=Q.i18n;X(Q,J,J.$T,H)})(function(X,H,C,Q){X.prototype.enc_pcm={stable:!0,fast:!0,getTestMsg:function(){return C("fWsN::pcmä¸ºæœªå°è£…çš„åŸå§‹éŸ³é¢‘æ•°æ®ï¼ŒpcméŸ³é¢‘æ–‡ä»¶æ— æ³•ç›´æ¥æ’­æ”¾ï¼Œå¯ç”¨Recorder.pcm2wav()è½¬ç æˆwavæ’­æ”¾ï¼›æ”¯æŒä½æ•°8ä½ã€16ä½ï¼ˆå¡«åœ¨æ¯”ç‰¹ç‡é‡Œé¢ï¼‰ï¼Œé‡‡æ ·ç‡å–å€¼æ— é™åˆ¶")}};var J=function(d){var K=d.bitRate,w=K==8?8:16;K!=w&&X.CLog(C("uMUJ::PCM Info: ä¸æ”¯æŒ{1}ä½ï¼Œå·²æ›´æ–°æˆ{2}ä½",0,K,w),3),d.bitRate=w};X.prototype.pcm=function(d,K,w){var z=this.set;J(z);var Y=te(d,z.bitRate);K(Y.buffer,"audio/pcm")};var te=function(d,K){if(K==8)for(var w=d.length,z=new Uint8Array(w),Y=0;Y<w;Y++){var L=(d[Y]>>8)+128;z[Y]=L}else{d=new Int16Array(d);var z=new Uint8Array(d.buffer)}return z};X.pcm2wav=function(d,K,w){d.blob||(d={blob:d});var z=d.blob,Y=d.sampleRate||16e3,L=d.bitRate||16;if((!d.sampleRate||!d.bitRate)&&X.CLog(C("KmRz::pcm2wavå¿…é¡»æä¾›sampleRateå’ŒbitRate"),3),!X.prototype.wav){w(C.G("NeedImport-2",["pcm2wav","src/engine/wav.js"]));return}var ne=function(oe,Ce){var fe;if(L==8){var he=new Uint8Array(oe);fe=new Int16Array(he.length);for(var ue=0;ue<he.length;ue++)fe[ue]=he[ue]-128<<8}else fe=new Int16Array(oe);var we=X({type:"wav",sampleRate:Y,bitRate:L});Ce&&(we.dataType="arraybuffer"),we.mock(fe,Y).stop(function(be,de,Te){K(be,de,Te)},w)};if(z instanceof ArrayBuffer)ne(z,1);else{var ie=new FileReader;ie.onloadend=function(){ne(ie.result)},ie.readAsArrayBuffer(z)}},X.prototype.pcm_envCheck=function(d,K){return""},X.prototype.pcm_start=function(d){return J(d),{set:d,memory:new Uint8Array(5e5),mOffset:0}};var s=function(d,K){var w=K.length;if(d.mOffset+w>d.memory.length){var z=new Uint8Array(d.memory.length+Math.max(5e5,w));z.set(d.memory.subarray(0,d.mOffset)),d.memory=z}d.memory.set(K,d.mOffset),d.mOffset+=w};X.prototype.pcm_stop=function(d){d&&d.memory&&(d.memory=null)},X.prototype.pcm_encode=function(d,K){if(d&&d.memory){var w=d.set,z=te(K,w.bitRate);w.takeoffEncodeChunk?w.takeoffEncodeChunk(z):s(d,z)}},X.prototype.pcm_complete=function(d,K,w,z){if(d&&d.memory){z&&this.pcm_stop(d);var Y=d.memory.buffer.slice(0,d.mOffset);K(Y,"audio/pcm")}else w(C("sDkA::pcmç¼–ç å™¨æœªstart"))}});const rr=er;class tr{closeRecorder(){this.recorder&&(this.recorder.close(),this.recorder=void 0)}async processWithAliyunAPI(H){if(this.callbacks)try{const C="https://agent.opentiny.design/api/asr/recognize",Q=new URLSearchParams({format:"pcm",sample_rate:"16000",enable_punctuation_prediction:"true",enable_inverse_text_normalization:"true"}),J=await fetch(`${C}?${Q.toString()}`,{method:"POST",body:H});if(!J.ok){const s=await J.text();throw new Error(`HTTP é”™è¯¯! çŠ¶æ€ç : ${J.status}, å“åº”: ${s}`)}const te=await J.json();if(te.data.status===2e7&&te.data.result){const s=te.data.result;this.callbacks.onFinal(s),this.callbacks.onEnd(s)}else throw new Error(te.message||`è¯†åˆ«å¤±è´¥ï¼ŒçŠ¶æ€ç : ${te.status}`)}catch(C){this.callbacks.onError(C instanceof Error?C:new Error("é˜¿é‡Œäº‘è¯­éŸ³è¯†åˆ«å¤±è´¥"))}}async start(H){this.callbacks=H;try{this.recorder=rr({type:"pcm",sampleRate:16e3,bitRate:16}),this.recorder.open(()=>{var C;(C=this.recorder)==null||C.start(),H.onStart()},(C,Q)=>{const J=Q?`ç”¨æˆ·æ‹’ç»äº†éº¦å…‹é£æƒé™: ${C}`:`æ— æ³•æ‰“å¼€éº¦å…‹é£: ${C}`;H.onError(new Error(J))})}catch(C){H.onError(C instanceof Error?C:new Error("é˜¿é‡Œäº‘è¯­éŸ³æœåŠ¡å¯åŠ¨å¤±è´¥"))}}async stop(){this.recorder&&this.recorder.stop((H,C)=>{console.log(`å½•éŸ³æˆåŠŸï¼Œæ ¼å¼: ${H.type}ï¼Œæ—¶é•¿: ${C}ms`,H),this.processWithAliyunAPI(H),this.closeRecorder()},H=>{var C;(C=this.callbacks)==null||C.onError(new Error(`å½•éŸ³å¤±è´¥: ${H}`)),this.closeRecorder()})}isSupported(){return!0}}const nr={style:{display:"flex","flex-direction":"column",gap:"20px"}},ar={key:0,style:{padding:"12px",background:"#e8f4fd","border-radius":"6px","border-left":"4px solid #1890ff"}},ir={style:{"font-weight":"500",color:"#1890ff"}},or={key:0,style:{"margin-top":"8px",color:"#666","font-style":"italic"}},sr={key:1,style:{padding:"16px",background:"#f9f9f9","border-radius":"8px"}},fr={style:{"max-height":"200px","overflow-y":"auto"}},lr={style:{"font-size":"12px",color:"#999","margin-bottom":"4px"}},vr=Ke({__name:"CustomSpeech",setup(X){const H=Le(""),C=Le(""),Q=Le(""),J=Le([]),te={customHandler:new tr,interimResults:!0},s=()=>{C.value="ğŸ¤ æ­£åœ¨å½•éŸ³...",Q.value=""},d=L=>{Q.value=L},K=L=>{C.value="âœ… è¯†åˆ«å®Œæˆ",Q.value="",J.value.unshift({text:L,timestamp:new Date().toLocaleTimeString()}),J.value.length>10&&(J.value=J.value.slice(0,10))},w=()=>{C.value="",Q.value=""},z=L=>{C.value="",Q.value="",console.error("è¯­éŸ³è¯†åˆ«é”™è¯¯:",L)},Y=L=>{console.log("æäº¤å†…å®¹:",L)};return(L,ne)=>(ye(),_e("div",nr,[C.value?(ye(),_e("div",ar,[ae("div",ir,Ie(C.value),1),Q.value?(ye(),_e("div",or," å®æ—¶è¯†åˆ«: "+Ie(Q.value),1)):Ee("",!0)])):Ee("",!0),ae("div",null,[ne[1]||(ne[1]=ae("h4",{style:{margin:"24px 0"}},"æ¨¡æ‹Ÿè¯­éŸ³è¯†åˆ«æ¼”ç¤º",-1)),qe(Qe(je),{modelValue:H.value,"onUpdate:modelValue":ne[0]||(ne[0]=ie=>H.value=ie),mode:"single",allowSpeech:!0,speech:te,placeholder:"ç‚¹å‡»éº¦å…‹é£æŒ‰é’®å¼€å§‹è¯­éŸ³è¾“å…¥...",onSpeechStart:s,onSpeechInterim:d,onSpeechFinal:K,onSpeechEnd:w,onSpeechError:z,onSubmit:Y},null,8,["modelValue"])]),J.value.length>0?(ye(),_e("div",sr,[ne[2]||(ne[2]=ae("h4",{style:{margin:"0 0 12px 0"}},"è¯†åˆ«å†å²",-1)),ae("div",fr,[(ye(!0),_e(Xe,null,Ye(J.value,(ie,oe)=>(ye(),_e("div",{key:oe,style:{padding:"8px","margin-bottom":"8px",background:"white","border-radius":"4px","border-left":"3px solid #52c41a"}},[ae("div",lr,Ie(ie.timestamp),1),ae("div",null,Ie(ie.text),1)]))),128))])])):Ee("",!0),ne[3]||(ne[3]=ae("div",{style:{padding:"16px",background:"#fffbe6","border-radius":"8px","border-left":"4px solid #faad14"}},[ae("h4",{style:{margin:"0 0 8px 0",color:"#fa8c16"}},"ä½¿ç”¨è¯´æ˜"),ae("ul",{style:{margin:"0","padding-left":"20px",color:"#666"}},[ae("li",null,"æ­¤ç¤ºä¾‹ä½¿ç”¨æ¨¡æ‹Ÿè¯­éŸ³è¯†åˆ«ï¼Œæ— éœ€çœŸå® API é…ç½®"),ae("li",null,"ç‚¹å‡»éº¦å…‹é£æŒ‰é’®åä¼šæ¨¡æ‹Ÿè¯­éŸ³è¯†åˆ«è¿‡ç¨‹ï¼Œå±•ç¤ºä¸­é—´ç»“æœå’Œæœ€ç»ˆç»“æœ"),ae("li",null,[Fe("å¦‚éœ€æ¥å…¥çœŸå®çš„è¯­éŸ³è¯†åˆ«æœåŠ¡ï¼ˆé˜¿é‡Œäº‘ç­‰ï¼‰ï¼Œè¯·å‚è€ƒ "),ae("code",null,"speechHandlers.ts"),Fe(" ä¸­çš„å®ç°ç¤ºä¾‹")]),ae("li",null,"æ”¯æŒè‡ªå®šä¹‰è¯­éŸ³å¤„ç†å™¨ï¼Œå®ç°ä»»æ„ç¬¬ä¸‰æ–¹è¯­éŸ³è¯†åˆ«æœåŠ¡çš„é›†æˆ")])],-1))]))}});export{vr as default};
